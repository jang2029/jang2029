# AbcExport -j '-frameRange 1 120 -stripNamespaces -uvWrite -writeColorSets -writeFaceSets -wholeFrameGeo -worldSpace -writeVisibility -eulerFilter -autoSubd -writeUVSets -dataFormat ogawa -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_upArm_Grp|Rt_Tricep_Geo -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_upArm_Grp|Rt_shoulder_circle_Geo -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_upArm_Grp|Rt_Shoulderpad_Geo -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_upArm_Grp|Rt_shoulder_det_Geo -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_upArm_Grp|Rt_bicepSidePanel_Geo -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_upArm_Grp|Rt_Wires_Geo -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_upArm_Grp|Rt_UpperArm_Geo -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_upArm_Grp|Rt_Shoulder_base_Geo -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_upArm_Grp|Rt_Top_Shoulder_Geo -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_loArm_Grp|Rt_Forearm_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_upArm_Grp|Lf_shoulder_circle_Geo -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_loArm_Grp|Rt_Wrist_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_upArm_Grp|Lf_Tricep_Geo -root |cRoot|GEO|NON_DEFORM|Rt_arm1_Geo_Grp|Rt_loArm_Grp|Rt_armBlade_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_upArm_Grp|Lf_Shoulder_base_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_upArm_Grp|Lf_bicepSidePanel_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_upArm_Grp|Lf_shoulderpad_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|chestrim_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|back_straps_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|chest_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|armsocket_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|neckline_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|Back_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|chestdetail3_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|chestdetail4_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|chest_studs_Geo -root |cRoot|GEO|NON_DEFORM|Head_Geo_Grp|eyes_Geo_old -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|back_det_Geo -root |cRoot|GEO|NON_DEFORM|Head_Geo_Grp|mask_Prnt_Grp|mask_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|back_rings_Geo -root |cRoot|GEO|NON_DEFORM|Head_Geo_Grp|mask_Prnt_Grp|face_wires_Geo -root |cRoot|GEO|NON_DEFORM|Head_Geo_Grp|mask_Prnt_Grp|lip_led_Geo -root |cRoot|GEO|DEFORM|Lf_eye_Geo -root |cRoot|GEO|DEFORM|Rt_eye_cornea_Geo -root |cRoot|GEO|DEFORM|Rt_Elbow_Geo -root |cRoot|GEO|DEFORM|face_Geo -root |cRoot|GEO|DEFORM|Lf_eye_cornea_Geo -root |cRoot|GEO|DEFORM|Rt_eye_Geo -root |cRoot|GEO|DEFORM|hair_Geo -root |cRoot|GEO|DEFORM|neckring_Geo -root |cRoot|GEO|DEFORM|Bot_Legs_Geo -root |cRoot|GEO|DEFORM|Rt_Fingers_Geo -root |cRoot|GEO|DEFORM|Jetpack_Geo -root |cRoot|GEO|DEFORM|Rt_Knuckles_Geo -root |cRoot|GEO|DEFORM|knee_studs_Geo -root |cRoot|GEO|DEFORM|accessories_Geo -root |cRoot|GEO|DEFORM|Lf_Knuckles_Geo -root |cRoot|GEO|DEFORM|Lf_Palm_Geo -root |cRoot|GEO|DEFORM|Hood_Geo -root |cRoot|GEO|DEFORM|Lf_Fingers_Geo -root |cRoot|GEO|DEFORM|Lf_Wrist_Cnxn_Geo -root |cRoot|GEO|DEFORM|Rt_Wrist_Cnxn_Geo -root |cRoot|GEO|DEFORM|Rt_Palm_Geo -root |cRoot|GEO|NON_DEFORM|Hood_Geo_Grp|collar_Geo -root |cRoot|GEO|NON_DEFORM|Hood_Geo_Grp|collarPiping_Geo -root |cRoot|GEO|NON_DEFORM|Hood_Geo_Grp|zipper_Geo -root |cRoot|GEO|NON_DEFORM|Hood_Geo_Grp|collarZipperFlap_Geo -root |cRoot|GEO|NON_DEFORM|Hood_Geo_Grp|collarTab_Geo -root |cRoot|GEO|NON_DEFORM|Legs_Geo_Grp|thigh_accessory_Geo_Grp|thighWrap_studs_Geo -root |cRoot|GEO|NON_DEFORM|Legs_Geo_Grp|thigh_accessory_Geo_Grp|straps_Geo -root |cRoot|GEO|NON_DEFORM|Legs_Geo_Grp|thigh_accessory_Geo_Grp|wrap_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_upArm_Grp|Lf_shoulder_det_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_loArm_Grp|Lf_Wrist_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_upArm_Grp|Lf_Top_Shoulder_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_upArm_Grp|Lf_Wires_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_upArm_Grp|Lf_UpperArm_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_loArm_Grp|Lf_Forearm_Geo -root |cRoot|GEO|NON_DEFORM|Lf_Frnt_Arm1_Geo_Grp|Lf_loArm_Grp|Lf_armBlade_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|chestdetail2_Geo -root |cRoot|GEO|NON_DEFORM|chest_Geo_Grp|chest_detail1_Geo -root |cRoot|GEO|DEFORM|Top_Legs_Geo -root |cRoot|GEO|DEFORM|Spine_Geo -root |cRoot|GEO|DEFORM|waist_Geo -root |cRoot|GEO|DEFORM|Lf_Elbow_Geo -file D:/test/ash_rig_main_v024.abc';

import maya.cmds as cmds


def exportAbc():

    selectedSet = cmds.ls(selection = True)
    cmds.select(selectedSet)
    selectedObj = cmds.ls(selection = True, l=True)
    
    
    
    startFrame = cmds.playbackOptions( q=True,min=True )
    endFrame  = cmds.playbackOptions( q=True,max=True )

    currentFile =  cmds.file(query=True, sceneName=True, shortName=True)
    fullpath =  cmds.file(query=True, sceneName=True)
    path = fullpath.replace(currentFile, '')
    abcFilename = path + currentFile.replace('.mb', '')+'.abc'
    print ( abcFilename )

    
    bakeObj = ' -root'.join(selectedObj)
    print (bakeObj)
    command = '-frameRange ' + str(startFrame) + ' ' + str(endFrame) + ' -stripNamespaces -uvWrite -writeColorSets -writeFaceSets -wholeFrameGeo -worldSpace -writeVisibility -eulerFilter -autoSubd -writeUVSets -dataFormat ogawa ' + bakeObj + ' -file ' + abcFilename
    cmds.AbcExport ( j = command )
    print (abcFilename)

exportAbc()

